<template>
  <div class="container-auth">
    <main class="content-auth" role="main">
      <div class="brand is-login">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 504.88 37.86"><path style="fill:#e7302f" d="M206.55 343.22h-5.16v-14.91l-9.58 15.24h-.33l-9.62-15.24v14.91h-5.17v-30.88h.17l14.78 22.58 14.74-22.58h.17zM236.23 332.44c0 6.82-4 11.32-11.52 11.32s-11.61-4.5-11.61-11.32v-19.57h5.17v19.24c0 4.13 2.23 6.9 6.44 6.9s6.36-2.77 6.36-6.9v-19.24h5.16zm-12.72-24a2.54 2.54 0 1 1-2.56-2.56 2.46 2.46 0 0 1 2.56 2.57zm7.43 0a2.54 2.54 0 1 1-2.56-2.56 2.46 2.46 0 0 1 2.56 2.57zM261.41 331.66v-18.79h5.16v30.89h-.17l-18.5-19.37v18.83h-5.16v-30.88h.17zM297.91 316.84l-3.26 3.71a10.2 10.2 0 0 0-7.73-3.47c-6 0-10.07 4.59-10.07 11S280.94 339 286.92 339a10 10 0 0 0 7.85-3.63l3.22 3.79c-2.89 3.18-6.52 4.59-11.07 4.59-8.87 0-15.27-6.73-15.27-15.69s6.4-15.73 15.27-15.73a14.29 14.29 0 0 1 10.99 4.51zM325.9 343.22h-5.16v-13.17h-13.83v13.17h-5.16v-30.35h5.16v12.47h13.83v-12.47h5.16zM356.83 343.22h-5.16v-13.17h-13.84v13.17h-5.16v-30.35h5.16v12.47h13.84v-12.47h5.16zM389.17 343.22h-5.62l-2.39-5.49h-12.72l-2.35 5.49h-5.62l14.24-30.88h.17zm-19-9.74h9.21L374.8 323zM398 338.64h13.75v4.58h-18.9v-30.35H398zM441.26 328c0 9.58-6 15.19-16.43 15.19h-9.37v-30.32h9.37c10.32 0 16.43 5.58 16.43 15.13zm-20.64-10.37v20.81h4.08c7.39 0 11.36-3.84 11.36-10.44s-4-10.37-11.36-10.37zM465.58 317.62h-14v8h12.22v4.5h-12.21v8.38h14.33v4.75h-19.49v-30.38h19.15zM489.6 331.66v-18.79h5.16v30.89h-.17l-18.5-19.37v18.83h-5.16v-30.88h.17zM521.13 315.6l-2.47 4.33a13.2 13.2 0 0 0-8-2.93c-3 0-5.29 1.32-5.29 4.13 0 2.27 1.32 3.34 6.19 4.34 7.6 1.65 10.2 4.17 10.2 8.79 0 5.66-4.25 9.5-11.1 9.5a17 17 0 0 1-11.44-4l2.85-4.25a12.67 12.67 0 0 0 8.71 3.55c3.51 0 5.82-1.53 5.82-4.33 0-2.27-1.69-3.55-6.56-4.55-7.56-1.65-9.83-4.29-9.83-8.79 0-5.41 4.29-9.08 10.49-9.08a17.74 17.74 0 0 1 10.43 3.29zM550 317.46h-10.26v25.76h-5.16v-25.76H524.3v-4.59H550zM570.91 343.22l-6.77-11.15H559v11.15h-5.16v-30.35h10.9c5.94 0 10.73 3.43 10.73 9.62a9 9 0 0 1-5.86 8.72l7.31 12zM559 327.57h5.28c3.6 0 6-1.73 6-5.08s-2.39-5.12-6-5.12H559zM608 343.22h-5.62l-2.38-5.49h-12.77l-2.35 5.49h-5.62l14.25-30.88h.16zm-19-9.74h9.21L593.59 323zM631.71 315.6l-2.47 4.33a13.2 13.2 0 0 0-8-2.93c-3 0-5.29 1.32-5.29 4.13 0 2.27 1.32 3.34 6.19 4.34 7.6 1.65 10.2 4.17 10.2 8.79 0 5.66-4.25 9.5-11.1 9.5a17 17 0 0 1-11.44-4l2.85-4.25a12.67 12.67 0 0 0 8.71 3.55c3.51 0 5.82-1.53 5.82-4.33 0-2.27-1.69-3.55-6.56-4.55-7.56-1.65-9.83-4.29-9.83-8.79 0-5.41 4.29-9.08 10.49-9.08a17.74 17.74 0 0 1 10.43 3.29zM656.54 315.6l-2.48 4.33a13.17 13.17 0 0 0-8-2.93c-3 0-5.28 1.32-5.28 4.13 0 2.27 1.32 3.34 6.19 4.34 7.6 1.65 10.2 4.17 10.2 8.79 0 5.66-4.25 9.5-11.11 9.5a17 17 0 0 1-11.43-4l2.84-4.25a12.71 12.71 0 0 0 8.72 3.55c3.51 0 5.82-1.53 5.82-4.33 0-2.27-1.69-3.55-6.57-4.55-7.55-1.65-9.82-4.29-9.82-8.79 0-5.41 4.29-9.08 10.48-9.08a17.75 17.75 0 0 1 10.44 3.29zM681.24 317.62h-14v8h12.22v4.5h-12.22v8.38h14.33v4.75h-19.49v-30.38h19.16z" transform="translate(-176.69 -305.89)"/></svg>
      </div>
      <header class="auth-header">
        <h1>Login</h1>
      </header>
      <form method="POST" class="login" v-on:submit.prevent="submitLogin">
        <div class="form-row">
          <label>E-Mail</label>
          <input type="email" required autofocus autocomplete="email" v-model="email">
        </div>
        <div class="form-row">
          <label>Password</label>
          <input id="password" type="password" required v-model="password">
        </div>
        <div class="form-row is-last">
          <div class="form-buttons">
            <input type="submit" class="btn" value="Login">
          </div>
        </div>
      </form>
    </main>
  </div>
</template>

<script>
  import store from '../../store'
  export default {
    data() {
      return {
        email: '',
        password: '',
        loginError: false,
      }
    },
    methods: {
      submitLogin() {
        this.loginError = false;
        axios.post('/api/auth/login', {
          email: this.email,
          password: this.password
        }).then(response => {
          store.commit('loginUser')
          localStorage.setItem('token', response.data.access_token)
          window.location.href = '/admin/apartements';
        }).catch(error => {
          this.loginError = true
        });
      }
    }
  }
</script>